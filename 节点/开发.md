# 节点开发

本节介绍 Python 节点的生命周期、数据获取与处理逻辑，以及标准的返回结果示例，帮助开发者快速实现自定义节点。

---

## 1. 节点生命周期

一个节点的典型生命周期包括以下几个阶段：

1. **初始化**：系统实例化节点对象，执行 `__init__` 方法，完成成员变量初始化。
2. **获取输入**：系统调用 `get_node_input` 方法，将上游节点或用户输入的数据传递给节点。
3. **获取配置**：系统调用 `get_user_input` 方法，将 config.json 中的配置项传递给节点。
4. **执行主逻辑**：系统调用 `execute` 方法，节点根据输入和配置执行核心处理。
5. **返回结果**：`execute` 方法返回结果，系统将其分发给下游节点或用于展示。

---

## 2. 数据获取与处理逻辑

节点通过以下方式获取输入和配置：

```python
class MainNode:
    def __init__(self):
        self.input_data = {}   # 存储输入参数
        self.config = {}       # 存储配置项

    def get_node_input(self, config):
        self.input_data = config  # 获取输入参数

    def get_user_input(self, config):
        self.config = {item['name']: item['default_value'] for item in config}  # 获取配置项

    def execute(self):
        # 获取输入值
        num1 = float(self.input_data.get('数值1', 0))
        num2 = float(self.input_data.get('数值2', 0))
        # 获取配置项
        operation = self.config.get('运算类型', 'all')
        # 处理逻辑
        result = {
            "outputs": {
                "加法结果": num1 + num2,
                "减法结果": num1 - num2
            }
        }
        return result
```

---

## 3. 返回结果的标准格式

- `execute` 方法必须返回一个字典，包含 `outputs` 字段。
- `outputs` 字典的 key 必须与 config.json 中 outputs 的 name 字段完全一致。
- 示例：

```python
return {
    "outputs": {
        "加法结果": 10,
        "减法结果": 2
    }
}
```

---

通过遵循上述生命周期和数据处理规范，开发者可以高效实现功能完备、易于集成的自定义节点。